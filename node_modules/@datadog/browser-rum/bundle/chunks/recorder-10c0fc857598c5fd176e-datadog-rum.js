(self.webpackChunk_datadog_browser_rum=self.webpackChunk_datadog_browser_rum||[]).push([["recorder"],{285(t,e,n){n.r(e),n.d(e,{startRecording:()=>ot});var o=n(534),s=n(725),r=n(362),i=n(769),a=n(300),c=n(474),u=n(197),d=n(44);function l(t){return!!t.changedTouches}function f(t){return!0===t.composed&&(0,d.XS)(t.target)?t.composedPath()[0]:t.target}const p=t=>({scale:t.scale,offsetLeft:t.offsetLeft,offsetTop:t.offsetTop,pageLeft:t.pageLeft,pageTop:t.pageTop,height:t.height,width:t.width});var m=n(749);function h(t,e){return{data:{source:t,...e},type:3,timestamp:(0,m.nx)()}}function g(t,e,n){const{throttled:o,cancel:s}=(0,c.n)(t=>{const o=f(t),s=e.nodeIds.get(o);if(void 0===s)return;const r=v(t);if(!r)return;const i={id:s,timeOffset:0,x:r.x,y:r.y};n(h(l(t)?6:1,{positions:[i]}))},50,{trailing:!1}),{stop:r}=(0,u.l)(t,document,["mousemove","touchmove"],o,{capture:!0,passive:!0});return{stop(){r(),s()}}}function v(t){let{clientX:e,clientY:n}=l(t)?t.changedTouches[0]:t;if(window.visualViewport){const{visualViewportX:t,visualViewportY:o}=((t,e)=>{const n=window.visualViewport,o={layoutViewportX:t,layoutViewportY:e,visualViewportX:t,visualViewportY:e};return n?(function(t){return Math.abs(t.pageTop-t.offsetTop-window.scrollY)>25||Math.abs(t.pageLeft-t.offsetLeft-window.scrollX)>25}(n)?(o.layoutViewportX=Math.round(t+n.offsetLeft),o.layoutViewportY=Math.round(e+n.offsetTop)):(o.visualViewportX=Math.round(t-n.offsetLeft),o.visualViewportY=Math.round(e-n.offsetTop)),o):o})(e,n);e=t,n=o}if(Number.isFinite(e)&&Number.isFinite(n))return{x:e,y:n}}const y={pointerup:0,mousedown:1,click:2,contextmenu:3,dblclick:4,focus:5,blur:6,touchstart:7,touchend:9};function w(t,e,n,o){return(0,u.l)(t,document,Object.keys(y),s=>{const r=f(s),i=e.nodeIds.get(r);if(void 0===i||(0,d.PJ)(r,t.defaultPrivacyLevel)===d.$m.HIDDEN)return;const a=y[s.type];let c;if(6!==a&&5!==a){const t=v(s);if(!t)return;c={id:i,type:a,x:t.x,y:t.y}}else c={id:i,type:a};const u={id:o.getIdForEvent(s),...h(2,c)};n(u)},{capture:!0,passive:!0})}function x(t,e,n,o,s=document){const{throttled:r,cancel:i}=(0,c.n)(s=>{const r=f(s);if(!r)return;const i=e.nodeIds.get(r);if(void 0===i||(0,d.PJ)(r,t.defaultPrivacyLevel)===d.$m.HIDDEN)return;const a=r===document?{scrollTop:(0,d.zL)(),scrollLeft:(0,d.Gn)()}:{scrollTop:Math.round(r.scrollTop),scrollLeft:Math.round(r.scrollLeft)};o.set(r,a),n(h(3,{id:i,x:a.scrollLeft,y:a.scrollTop}))},100),{stop:a}=(0,u.q)(t,s,"scroll",r,{capture:!0,passive:!0});return{stop(){a(),i()}}}function S(t,e){const n=(0,d.g1)(t).subscribe(t=>{e(h(4,t))});return{stop(){n.unsubscribe()}}}function b(t,e){const n=window.visualViewport;if(!n)return{stop:c.l};const{throttled:o,cancel:s}=(0,c.n)(()=>{e({data:p(n),type:8,timestamp:(0,m.nx)()})},200,{trailing:!1}),{stop:r}=(0,u.l)(t,n,["resize","scroll"],o,{capture:!0,passive:!0});return{stop(){r(),s()}}}function N(t,e,n){return(0,u.l)(t,document,["play","pause"],o=>{const s=f(o);if(!s)return;const r=e.nodeIds.get(s);void 0!==r&&(0,d.PJ)(s,t.defaultPrivacyLevel)!==d.$m.HIDDEN&&n(h(7,{id:r,type:"play"===o.type?0:1}))},{capture:!0,passive:!0})}var T=n(801);function E(t,e){function n(e,n){if(!e||!e.ownerNode)return;const o=t.nodeIds.get(e.ownerNode);void 0!==o&&n(o)}const o=[(0,T.H)(CSSStyleSheet.prototype,"insertRule",({target:t,parameters:[o,s]})=>{n(t,t=>e(h(8,{id:t,adds:[{rule:o,index:s}]})))}),(0,T.H)(CSSStyleSheet.prototype,"deleteRule",({target:t,parameters:[o]})=>{n(t,t=>e(h(8,{id:t,removes:[{index:o}]})))})];function s(t){o.push((0,T.H)(t.prototype,"insertRule",({target:t,parameters:[o,s]})=>{n(t.parentStyleSheet,n=>{const r=I(t);r&&(r.push(s||0),e(h(8,{id:n,adds:[{rule:o,index:r}]})))})}),(0,T.H)(t.prototype,"deleteRule",({target:t,parameters:[o]})=>{n(t.parentStyleSheet,n=>{const s=I(t);s&&(s.push(o),e(h(8,{id:n,removes:[{index:s}]})))})}))}return"undefined"!=typeof CSSGroupingRule?s(CSSGroupingRule):(s(CSSMediaRule),s(CSSSupportsRule)),{stop(){o.forEach(t=>t.stop())}}}function I(t){const e=[];let n=t;for(;n.parentRule;){const t=Array.from(n.parentRule.cssRules).indexOf(n);e.unshift(t),n=n.parentRule}if(!n.parentStyleSheet)return;const o=Array.from(n.parentStyleSheet.cssRules).indexOf(n);return e.unshift(o),e}function C(t,e){return(0,u.l)(t,window,["focus","blur"],()=>{e({data:{has_focus:document.hasFocus()},type:6,timestamp:(0,m.nx)()})})}function _(t,e,n){const o=t.subscribe(12,t=>{var o,s;t.rawRumEvent.type===d.bb.ACTION&&t.rawRumEvent.action.type===d.X2.CLICK&&(null===(s=null===(o=t.rawRumEvent.action.frustration)||void 0===o?void 0:o.type)||void 0===s?void 0:s.length)&&"events"in t.domainContext&&t.domainContext.events&&t.domainContext.events.length&&e({timestamp:t.rawRumEvent.date,type:9,data:{frustrationTypes:t.rawRumEvent.action.frustration.type,recordIds:t.domainContext.events.map(t=>n.getIdForEvent(t))}})});return{stop(){o.unsubscribe()}}}function R(t,e){const n=t.subscribe(5,()=>{e({timestamp:(0,m.nx)(),type:7})});return{stop(){n.unsubscribe()}}}var D=n(877);function L(t,e){const n=t.tagName,o=t.value;if((0,d.Ie)(t,e)){const e=t.type;if("INPUT"===n&&("button"===e||"submit"===e||"reset"===e))return o;if(!o||"OPTION"===n)return;return d.o}return"OPTION"===n||"SELECT"===n?t.value:"INPUT"===n||"TEXTAREA"===n?o:void 0}const O=/url\((?:(')([^']*)'|(")([^"]*)"|([^)]*))\)/gm,M=/^[A-Za-z]+:|^\/\//,z=/^["']?data:.*,/i,A=/[^a-z1-6-_]/;function k(t){const e=t.toLowerCase().trim();return A.test(e)?"div":e}function P(t,e){return`data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='${t}' height='${e}' style='background-color:silver'%3E%3C/svg%3E`}function $(t){if(void 0!==t&&0!==t.length)return t.map(t=>{const e=t.cssRules||t.rules;return{cssRules:Array.from(e,t=>t.cssText),disabled:t.disabled||void 0,media:t.media.length>0?Array.from(t.media):void 0}})}var H=n(760);function V(t,e,n,o){if(e===d.$m.HIDDEN)return null;const s=t.getAttribute(n);if(e===d.$m.MASK&&n!==d.NT&&!d.yF.includes(n)&&n!==o.actionNameAttribute){const e=t.tagName;switch(n){case"title":case"alt":case"placeholder":return d.o}if("IMG"===e&&("src"===n||"srcset"===n)){const e=t;if(e.naturalWidth>0)return P(e.naturalWidth,e.naturalHeight);const{width:n,height:o}=t.getBoundingClientRect();return n>0||o>0?P(n,o):d.eT}if("SOURCE"===e&&("src"===n||"srcset"===n))return d.eT;if("A"===e&&"href"===n)return d.o;if(s&&n.startsWith("data-"))return d.o;if("IFRAME"===e&&"srcdoc"===n)return d.o}return s&&"string"==typeof s?(0,d.ei)(s,1e6):s}function F(t,e,n){t[e].count+=1,t[e].max=Math.max(t[e].max,n),t[e].sum+=n}function G(t){if(!t)return null;let e;try{e=t.rules||t.cssRules}catch(t){}return e?(n=Array.from(e,(0,H.nr)()?B:J).join(""),o=t.href,n.replace(O,(t,e,n,s,r,i)=>{const a=n||r||i;if(!o||!a||M.test(a)||z.test(a))return t;const c=e||s||"";return`url(${c}${function(t,e){try{return(0,D.c$)(t,e).href}catch(e){return t}}(a,o)}${c})`})):null;var n,o}function B(t){if(function(t){return"selectorText"in t}(t)&&t.selectorText.includes(":")){const e=/(\[[\w-]+[^\\])(:[^\]]+\])/g;return t.cssText.replace(e,"$1\\$2")}return J(t)}function J(t){return function(t){return"styleSheet"in t}(t)&&G(t.styleSheet)||t.cssText}function W(t,e,n){const o=function(t,e,n){switch(t.nodeType){case t.DOCUMENT_NODE:return function(t,e,n){return{type:0,childNodes:X(t,e,n),adoptedStyleSheets:$(t.adoptedStyleSheets)}}(t,e,n);case t.DOCUMENT_FRAGMENT_NODE:return function(t,e,n){const o=(0,d.p_)(t);return o&&n.serializationContext.shadowRootsController.addShadowRoot(t),{type:11,childNodes:X(t,e,n),isShadowRoot:o,adoptedStyleSheets:o?$(t.adoptedStyleSheets):void 0}}(t,e,n);case t.DOCUMENT_TYPE_NODE:return{type:1,name:(o=t).name,publicId:o.publicId,systemId:o.systemId};case t.ELEMENT_NODE:return function(t,e,n){const o=k(t.tagName),s="svg"===(i=t).tagName||i instanceof SVGElement||void 0,r=(0,d.jR)((0,d.dT)(t),e);var i;if(r===d.$m.HIDDEN){const{width:e,height:n}=t.getBoundingClientRect();return{type:2,tagName:o,attributes:{rr_width:e+"px",rr_height:n+"px",[d.NT]:d.Wd},childNodes:[],isSVG:s}}if(r===d.$m.IGNORE)return;const a=function(t,e,n){if(e===d.$m.HIDDEN)return{};const o={},s=k(t.tagName),r=t.ownerDocument;for(let s=0;s<t.attributes.length;s+=1){const r=t.attributes.item(s).name,i=V(t,e,r,n.configuration);null!==i&&(o[r]=i)}if(t.value&&("textarea"===s||"select"===s||"option"===s||"input"===s)){const n=L(t,e);void 0!==n&&(o.value=n)}if("option"===s&&e===d.$m.ALLOW){const e=t;e.selected&&(o.selected=e.selected)}if("link"===s){const e=Array.from(r.styleSheets).find(e=>e.href===t.href),s=G(e);s&&e&&(F(n.serializationContext.serializationStats,"cssText",s.length),o._cssText=s)}if("style"===s&&t.sheet){const e=G(t.sheet);e&&(F(n.serializationContext.serializationStats,"cssText",e.length),o._cssText=e)}const i=t;if("input"!==s||"radio"!==i.type&&"checkbox"!==i.type||(e===d.$m.ALLOW?o.checked=!!i.checked:(0,d.Ie)(i,e)&&delete o.checked),"audio"===s||"video"===s){const e=t;o.rr_mediaState=e.paused?"paused":"played"}let a,c;const u=n.serializationContext;switch(u.status){case 0:a=Math.round(t.scrollTop),c=Math.round(t.scrollLeft),(a||c)&&u.elementsScrollPositions.set(t,{scrollTop:a,scrollLeft:c});break;case 1:u.elementsScrollPositions.has(t)&&({scrollTop:a,scrollLeft:c}=u.elementsScrollPositions.get(t))}return c&&(o.rr_scrollLeft=c),a&&(o.rr_scrollTop=a),o}(t,r,n);let c=[];return(0,d.wR)(t)&&"style"!==o&&(c=X(t,r,n)),{type:2,tagName:o,attributes:a,childNodes:c,isSVG:s}}(t,e,n);case t.TEXT_NODE:return function(t,e){const n=(0,d.rf)(t,e);if(void 0!==n)return{type:3,textContent:n}}(t,e);case t.CDATA_SECTION_NODE:return{type:4,textContent:""}}var o}(t,e,n);if(!o)return null;const s=n.scope.nodeIds.assign(t),r=o;return r.id=s,n.serializedNodeIds&&n.serializedNodeIds.add(s),r}function X(t,e,n){const o=[];return(0,d.wI)(t,t=>{const s=W(t,e,n);s&&o.push(s)}),o}function Y(t,e,n,o){const s=(0,m.nx)(),r=W(t,e.defaultPrivacyLevel,{serializationContext:o,configuration:e,scope:n});return F(o.serializationStats,"serializationDuration",(0,m.vk)(s,(0,m.nx)())),r}function U(t,e,n,o=document){const s=t.defaultPrivacyLevel,r=new WeakMap,i=o!==document,{stop:a}=(0,u.l)(t,o,i?["change"]:["input","change"],t=>{const e=f(t);(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement||e instanceof HTMLSelectElement)&&p(e)},{capture:!0,passive:!0});let l;if(i)l=c.l;else{const t=[(0,T.t)(HTMLInputElement.prototype,"value",p),(0,T.t)(HTMLInputElement.prototype,"checked",p),(0,T.t)(HTMLSelectElement.prototype,"value",p),(0,T.t)(HTMLTextAreaElement.prototype,"value",p),(0,T.t)(HTMLSelectElement.prototype,"selectedIndex",p)];l=()=>{t.forEach(t=>t.stop())}}return{stop(){l(),a()}};function p(t){const n=(0,d.PJ)(t,s);if(n===d.$m.HIDDEN)return;const o=t.type;let r;if("radio"===o||"checkbox"===o){if((0,d.Ie)(t,n))return;r={isChecked:t.checked}}else{const e=L(t,n);if(void 0===e)return;r={text:e}}m(t,r,e);const i=t.name;"radio"===o&&i&&t.checked&&document.querySelectorAll(`input[type="radio"][name="${CSS.escape(i)}"]`).forEach(n=>{n!==t&&m(n,{isChecked:!1},e)})}function m(t,e,o){const s=o.nodeIds.get(t);if(void 0===s)return;const i=r.get(t);i&&i.text===e.text&&i.isChecked===e.isChecked||(r.set(t,e),n(h(5,{id:s,...e})))}}var q=n(315),j=n(981);function K(t,e,n,o,s){const r=(0,d.W3)();if(!r)return{stop:c.l,flush:c.l};const i=function(){let s=c.l,r=[];function i(){s(),function(t,e,n,o,s){const r=new Map;t.filter(t=>"childList"===t.type).forEach(t=>{t.removedNodes.forEach(t=>{Z(t,s.removeShadowRoot)})});const i=t.filter(t=>t.target.isConnected&&o.nodeIds.areAssignedForNodeAndAncestors(t.target)&&(0,d.PJ)(t.target,n.defaultPrivacyLevel,r)!==d.$m.HIDDEN),a={cssText:{count:0,max:0,sum:0},serializationDuration:{count:0,max:0,sum:0}},{adds:c,removes:u,hasBeenSerialized:l}=function(t,e,n,o,s,r){const i=new Set,a=new Map;for(const e of t)e.addedNodes.forEach(t=>{i.add(t)}),e.removedNodes.forEach(t=>{i.has(t)||a.set(t,e.target),i.delete(t)});const c=Array.from(i);c.sort((t,e)=>{const n=t.compareDocumentPosition(e);return n&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:n&Node.DOCUMENT_POSITION_CONTAINS||n&Node.DOCUMENT_POSITION_FOLLOWING?1:n&Node.DOCUMENT_POSITION_PRECEDING?-1:0});const u=new Set,l={status:2,serializationStats:o,shadowRootsController:s},f=[];for(const t of c){if(h(t))continue;const s=(0,d.PJ)(t.parentNode,e.defaultPrivacyLevel,r);if(s===d.$m.HIDDEN||s===d.$m.IGNORE)continue;const i=(0,m.nx)(),a=W(t,s,{serializedNodeIds:u,serializationContext:l,configuration:e,scope:n});if(F(o,"serializationDuration",(0,m.vk)(i,(0,m.nx)())),!a)continue;const c=(0,d.$4)(t);f.push({nextId:g(t),parentId:n.nodeIds.get(c),node:a})}const p=[];return a.forEach((t,e)=>{const o=n.nodeIds.get(t),s=n.nodeIds.get(e);void 0!==o&&void 0!==s&&p.push({parentId:o,id:s})}),{adds:f,removes:p,hasBeenSerialized:h};function h(t){const e=n.nodeIds.get(t);return void 0!==e&&u.has(e)}function g(t){let e=t.nextSibling;for(;e;){const t=n.nodeIds.get(e);if(void 0!==t)return t;e=e.nextSibling}return null}}(i.filter(t=>"childList"===t.type),n,o,a,s,r),f=function(t,e,n,o){var s;const r=[],i=new Set,a=t.filter(t=>!i.has(t.target)&&(i.add(t.target),!0));for(const t of a){if(t.target.textContent===t.oldValue)continue;const i=n.nodeIds.get(t.target);if(void 0===i)continue;const a=(0,d.PJ)((0,d.$4)(t.target),e.defaultPrivacyLevel,o);a!==d.$m.HIDDEN&&a!==d.$m.IGNORE&&r.push({id:i,value:null!==(s=(0,d.rf)(t.target,a))&&void 0!==s?s:null})}return r}(i.filter(t=>"characterData"===t.type&&!l(t.target)),n,o,r),p=function(t,e,n,o){const s=[],r=new Map,i=t.filter(t=>{const e=r.get(t.target);return!(e&&e.has(t.attributeName)||(e?e.add(t.attributeName):r.set(t.target,new Set([t.attributeName])),0))}),a=new Map;for(const t of i){if(t.target.getAttribute(t.attributeName)===t.oldValue)continue;const r=n.nodeIds.get(t.target);if(void 0===r)continue;const i=(0,d.PJ)(t.target,e.defaultPrivacyLevel,o),c=V(t.target,i,t.attributeName,e);let u;if("value"===t.attributeName){const e=L(t.target,i);if(void 0===e)continue;u=e}else u="string"==typeof c?c:null;let l=a.get(t.target);l||(l={id:r,attributes:{}},s.push(l),a.set(t.target,l)),l.attributes[t.attributeName]=u}return s}(i.filter(t=>"attributes"===t.type&&!l(t.target)),n,o,r);(f.length||p.length||u.length||c.length)&&e(h(0,{adds:c,removes:u,texts:f,attributes:p}),a)}(r.concat(a.takeRecords()),t,e,n,o),r=[]}const{throttled:u,cancel:l}=(0,c.n)(i,16,{leading:!1});return{addMutations(t){0===r.length&&(s=(0,j.BB)(u,{timeout:100})),r.push(...t)},flush:i,stop(){s(),l()}}}(),a=new r((0,q.dm)(i.addMutations));return a.observe(s,{attributeOldValue:!0,attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),{stop(){a.disconnect(),i.stop()},flush(){i.flush()}}}function Z(t,e){(0,d.XS)(t)&&e(t.shadowRoot),(0,d.wI)(t,t=>Z(t,e))}var Q=n(887),tt=n(636);function et({context:t,creationReason:e,encoder:n}){let o=0;const s=t.view.id,r={start:1/0,end:-1/0,creation_reason:e,records_count:0,has_full_snapshot:!1,index_in_view:a.K_(s),source:"browser",...t},i={cssText:{count:0,max:0,sum:0},serializationDuration:{count:0,max:0,sum:0}};return a.H5(s),{addRecord(t,e,s){r.start=Math.min(r.start,t.timestamp),r.end=Math.max(r.end,t.timestamp),r.records_count+=1,r.has_full_snapshot||(r.has_full_snapshot=2===t.type),e&&function(t,e){for(const n of["cssText","serializationDuration"])t[n].count+=e[n].count,t[n].max=Math.max(t[n].max,e[n].max),t[n].sum+=e[n].sum}(i,e);const a=n.isEmpty?'{"records":[':",";n.write(a+JSON.stringify(t),t=>{o+=t,s(o)})},flush(t){if(n.isEmpty)throw Error("Empty segment flushed");n.write(`],${JSON.stringify(r).slice(1)}\n`),n.finish(e=>{a.L7(r.view.id,e.rawBytesCount),t(r,i,e)})}}}const nt=5*m.OY;function ot(t,e,n,u,l,f,h){const v=[],y=h||(0,s.sA)([e.sessionReplayEndpointBuilder],6e4,e=>{t.notify(14,{error:e}),(0,o.A2)("Error reported to customer",{"error.message":e.message})});let T;if((0,r.d0)())({addRecord:T}=function(t){const e=(0,r.Y9)();return{addRecord(n){const o=t.findView();e.send("record",n,o.id)}}}(u));else{const s=function(t,e,n,o,s,r){return function(t,s,r,i){let a={status:0,nextSegmentCreationReason:"init"};const{unsubscribe:c}=t.subscribe(2,()=>{d("view_change")}),{unsubscribe:u}=t.subscribe(11,t=>{d(t.reason)});function d(t){1===a.status&&(a.segment.flush((e,n,o)=>{const s=function(t,e,n,o){const s=new FormData;s.append("segment",new Blob([t],{type:"application/octet-stream"}),`${e.session.id}-${e.start}`);const r={raw_segment_size:o,compressed_segment_size:t.byteLength,...e},i=JSON.stringify(r);return s.append("event",new Blob([i],{type:"application/json"})),{data:s,bytesCount:t.byteLength,cssText:n.cssText,isFullSnapshot:0===e.index_in_view,rawSize:o,recordCount:e.records_count,serializationDuration:n.serializationDuration}}(o.output,e,n,o.rawBytesCount);(0,Q.Kp)(t)?r.sendOnExit(s):r.send(s)}),(0,tt.DJ)(a.expirationTimeoutId)),a="stop"!==t?{status:0,nextSegmentCreationReason:t}:{status:2}}return{addRecord(t,s){if(2!==a.status){if(0===a.status){const t=function(t,e,n){const o=e.findTrackedSession(),s=n.findView();if(o&&s)return{application:{id:t},session:{id:o.id},view:{id:s.id}}}(e.applicationId,n,o);if(!t)return;a={status:1,segment:et({encoder:i,context:t,creationReason:a.nextSegmentCreationReason}),expirationTimeoutId:(0,tt.wg)(()=>{d("segment_duration_limit")},nt)}}a.segment.addRecord(t,s,t=>{t>6e4&&d("segment_bytes_limit")})}},stop(){d("stop"),c(),u()}}}(t,0,s,r)}(t,e,n,u,y,l);T=s.addRecord,v.push(s.stop);const r=function(t,e){if(!t.metricsEnabled)return{stop:c.l};const{unsubscribe:n}=e.subscribe(t=>{if("failure"===t.type||"queue-full"===t.type||"success"===t.type&&t.payload.isFullSnapshot){const r=(e=t.type,n=t.bandwidth,{cssText:{count:(s=t.payload).cssText.count,max:s.cssText.max,sum:s.cssText.sum},isFullSnapshot:s.isFullSnapshot,ongoingRequests:{count:n.ongoingRequestCount,totalSize:n.ongoingByteCount},recordCount:s.recordCount,result:e,serializationDuration:{count:s.serializationDuration.count,max:s.serializationDuration.max,sum:s.serializationDuration.sum},size:{compressed:s.bytesCount,raw:s.rawSize}});(0,o.Gk)("Segment network request metrics",{metrics:r})}var e,n,s});return{stop:n}}(f,y.observable);v.push(r.stop)}const{stop:I}=function(t){const{emit:e,configuration:n,lifeCycle:o}=t;if(!e)throw Error("emit function is required");const s=(n,o)=>{e(n,o),(0,i.b)("record",{record:n});const s=t.viewHistory.findView();a.$1(s.id)},r=function(){const t=new WeakMap;return{set(e,n){(e!==document||document.scrollingElement)&&t.set(e===document?document.scrollingElement:e,n)},get(e){return t.get(e)},has(e){return t.has(e)}}}(),c={nodeIds:function(){const t=new WeakMap;let e=1;const n=e=>t.get(e);return{assign(o){let s=n(o);return void 0===s&&(s=e++,t.set(o,s)),s},get:n,areAssignedForNodeAndAncestors(t){let e=t;for(;e;){if(void 0===n(e)&&!(0,d.p_)(e))return!1;e=(0,d.$4)(e)}return!0}}}()},u=((t,e,n,o)=>{const s=new Map,r={addShadowRoot(i){if(s.has(i))return;const a=K(n,t,e,r,i),c=U(t,e,n,i),u=x(t,e,n,o,i);s.set(i,{flush:()=>a.flush(),stop(){a.stop(),c.stop(),u.stop()}})},removeShadowRoot(t){const e=s.get(t);e&&(e.stop(),s.delete(t))},stop(){s.forEach(({stop:t})=>t())},flush(){s.forEach(({flush:t})=>t())}};return r})(n,c,s,r),{stop:l}=function(t,e,n,o,s,r,i){const a=(n,r)=>{const{width:a,height:c}=(0,d.pB)();i({data:{height:c,href:window.location.href,width:a},type:4,timestamp:n}),i({data:{has_focus:document.hasFocus()},type:6,timestamp:n});const u={cssText:{count:0,max:0,sum:0},serializationDuration:{count:0,max:0,sum:0}};i({data:{node:Y(document,o,s,{status:r,elementsScrollPositions:t,serializationStats:u,shadowRootsController:e}),initialOffset:{left:(0,d.Gn)(),top:(0,d.zL)()}},type:2,timestamp:n},u),window.visualViewport&&i({data:p(window.visualViewport),type:8,timestamp:n})};a((0,m.nx)(),0);const{unsubscribe:c}=n.subscribe(2,t=>{r(),a(t.startClocks.timeStamp,1)});return{stop:c}}(r,u,o,n,c,f,s);function f(){u.flush(),v.flush()}const h=function(){const t=new WeakMap;let e=1;return{getIdForEvent(n){return t.has(n)||t.set(n,e++),t.get(n)}}}(),v=K(s,n,c,u,document),y=[v,g(n,c,s),w(n,c,s,h),x(n,c,s,r,document),S(n,s),U(n,c,s),N(n,c,s),E(c,s),C(n,s),b(n,s),_(o,s,h),R(o,t=>{f(),s(t)})];return{stop(){u.stop(),y.forEach(t=>t.stop()),l()},flushMutations:f,shadowRootsController:u}}({emit:T,configuration:e,lifeCycle:t,viewHistory:u});return v.push(I),{stop(){v.forEach(t=>t())}}}}}]);